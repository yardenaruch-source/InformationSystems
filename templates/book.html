{% extends "base.html" %}
{% block title %}Book A Flight{% endblock %}

{% block content %}
<div class="board">
  <form class="board-search" method="get" action="{{ url_for('book') }}">
    <div class="board-field">
      <label>Origin</label>
      <select name="origin" required>
        <option value="">Select Origin</option>
        {% for a in airports %}
          <option value="{{ a }}" {% if origin == a %}selected{% endif %}>{{ a }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="board-field">
      <label>Destination</label>
      <select name="destination" required>
        <option value="">Select Destination</option>
        {% for a in airports %}
          <option value="{{ a }}" {% if destination == a %}selected{% endif %}>{{ a }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="board-field">
      <label>Date</label>
      <input type="date" name="date" value="{{ date or '' }}" required>
    </div>

    <button class="btn" type="submit">Search</button>
  </form>

  <div class="board-table-wrap">
    <table class="board-table">
      <thead>
        <tr>
          <th>Flight No.</th>
          <th>Origin</th>
          <th>Destination</th>
          <th>Takeoff Date</th>
          <th>Takeoff Time</th>
          <th>Landing Date</th>
          <th>Landing Time</th>
          <th>From Price</th>
          <th>Book</th>
        </tr>
      </thead>

      <tbody>
        {% if flights and flights|length > 0 %}
          {% for f in flights %}
          <tr>
            <td>{{ f.flight_id }}</td>
            <td>{{ f.origin_airport }}</td>
            <td>{{ f.destination_airport }}</td>
            <td>{{ f.takeoff_date }}</td>
            <td>{{ f.takeoff_time }}</td>
            <td>{{ f.landing_date }}</td>
            <td>{{ f.landing_time }}</td>
            <td>â‚ª{{ f.from_price }}</td>
            <td>
              {% if session.get('user_email') %}
                <a class="btn"
                   href="{{ url_for('customer_details', flight_id=f.flight_id, next=url_for('flight_details', flight_id=f.flight_id)) }}">
                  Book
                </a>
              {% else %}
                <a class="btn"
                   href="{{ url_for('booking_log', flight_id=f.flight_id, next=url_for('flight_details', flight_id=f.flight_id)) }}">
                  Book
                </a>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        {% else %}
          <tr>
            <td colspan="9" class="empty-row">No flights found. Try searching.</td>
          </tr>
        {% endif %}
      </tbody>
    </table>
  </div>

  <div class="board-pager">
    <button class="pager-btn" type="button" disabled>Previous</button>
    <button class="pager-btn" type="button" disabled>Next</button>
  </div>
</div>

{% endblock %}